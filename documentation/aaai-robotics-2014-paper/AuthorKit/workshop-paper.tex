%File: formatting-instruction.tex
\documentclass[letterpaper]{article}
\usepackage{aaai}
\usepackage{times}
\usepackage{helvet}
\usepackage{courier}
\frenchspacing
\setlength{\pdfpagewidth}{8.5in}
\setlength{\pdfpageheight}{11in}
\pdfinfo{
/Title (Control of a Robot Arm with Artifical and Biological Neural Networks)
/Author (Abraham Shultz, Holly Yanco, Thomas Shea)}
\setcounter{secnumdepth}{0}  

\newcommand{\superscript}[1]{\ensuremath{^{\textrm{\scriptsize{#1}}}}}
\newcommand{\subscript}[1]{\ensuremath{_{\textrm{\scriptsize{#1}}}}}

 \begin{document}
% The file aaai.sty is the style file for AAAI Press 
% proceedings, working notes, and technical reports.
%
\title{Control of a Robot Arm with Artifical and Biological Neural Networks}
\author{Abraham Shultz, Holly Yanco, Thomas Shea\\
University of Massachusetts Lowell\\
1 University Avenue\\
Lowell, Massachusetts 01835\\
}
\maketitle
\begin{abstract}
\begin{quote}
In order to perform reasearch on learning in cultures of mouse neurons, a hardware and software for interfacing a biological neuronal culture to a robot arm has been constructed. 
The software architecture is modular, which permits simulated neurons to be used in place of biological neurons. 
In either case, the activity of the culture over time is represented as an activation vector that captures recent spatiotemporal patterns of neuron firing. 
The activation vector is converted into control signals for the arm in a manner that can be generalized to multiple degrees of freedom. 
Preliminary results from execution of the system with simulated and real cultures are presented. 
\end{quote}
\end{abstract}

\section{Introduction}

To study the behavior of small networks of biological neurons, the neurons can be cultured \textit{in vitro} and examined more easily than they could be in a living organism. 
Living organisms, unlike cultures, have constant experience of the outside world through their senses. 
This embodiment is crucial to the development of the organism as a competent actor in the world.
Embodiment allows the pre-existing structures of the brain to acquire their full development by reinforcing those connections which lead to successful action and diminishing those which result in failure. 

However, we do not propose that biological neurons in culture will be able to develop into an effective controller for a robotic system.
Neurons are very sensitive to their environment, and can only live in a very narrowly proscribed range of conditions. 
Outside those conditions, or if they are contaminated by bacteria, the cells die. 
Additionally, each culture is unique. Multiple cultures may be created with similar initial conditions, but the cells will be uniquely laid out and connected. 
As a result, while one can make broad and statistical assertions about their behavior, there is not a high level of inter-cultural similarity at the level of individual signaling patterns. 

The fact that biological cultures, as currently used, do not make a robust and repeatable robot controller does not mean that embodying neuronal cultures in robotic systems is useless. 
Rather, embodiment provides us with a means of learning about the connectivity and growth of neurons in culture. 
To that end, we have constructed a closed loop of perception, stimulation, activation, and action that allows cultured mouse neurons to interact with the real world.

\section{Methods}

There are two components of the research. 
The first component is the growth of biological neuronal networks for use as robotic controllers; the second is the simulation of these cultures \textit{in silico} to guide future research. 
By using the observed behavior of the cultured neurons to guide the development of the software for the simulator, we hope to produce an accurate simulator. 
As the simulator's accuracy improves, it will be able to be used to simulate very large series of experiments in order to guide future research with biological cells in useful directions. 

\subsection{Biological Cultured Neuronal Networks}

In order to gather information about about the behavior of neurons, neurobiology researchers grow cultures of neurons.
These cultures of neurons allow the researchers to perform experiments that operate directly on the neurons, without the complications that may be caused by the interacting systems of a living organism. 
For example, tetrodotoxin (TTX) prevents sodium channels from acting, which prevents neurons from signaling to each other. 
In culture, the suppression of signaling does not kill the neurons, and can be reversed by removing the TTX. 
However, in organisms, the action of TTX paralyzes the respiratory muscles, which kills the animal.  

Despite the advantages of cultures, they also have drawbacks. 
In culture, a neuronal network does not receive stimulation unless it is provided by the researcher. 
Complete organisms receive stimulation from their senses for their entire lives. 
Before birth, the genetic and chemical signaling within the organism organizes and differentiates the developing neuronal tissue into specialized layers and structures. 
After the organism is born, and actually for some time before birth, incoming sensory information is handled by the pre-existing organization within the brain to form impressions of the outside world. 
The propagation of these impressions through the brain results, eventually, in motor activity, which in turn changes the organism's relation to the world and the resulting sensory input. 
This complete loop is what we mean when we talk about embodiment: the ability of a system to perceive the outside world, process that perception, and act in the world. 
The brain closes the gap between perception and action, while the world closes the loop between action and perception. 
By embodying neuronal cultures in a robot, we hope to provide a framework for investigating how incoming signals are integrated by neuronal networks, and how this integration affects the structure of the network. 

\subsection{Experimental Uses}

A Multi-Electrode Array (MEA) is a type of culture dish that provides researchers with a way to monitor the electrical activity of neurons at or near the level of individual cells. 

Because the cells are grown in a culture medium, chemicals can be added to or removed from their environment to modify their ability to signal. 
Research in Thomas Shea's lab \cite{shea2009optimization} has used this method to demonstrate that inhibitory connections are required for learning in cultured neurons. 
For the purposes of this thesis, the neurons under discussion are a culture of disassociated mouse neurons.   

\subsection{Construction}
The MEA itself consists of a glass plate with an array of conductive pads laid out on it, as shown in Figure \ref{fig:MEA_layout}.
Conductive traces extend from each pad to the edges of the plate. 
These conductive pads are used to detect the electrical activity of neurons cultured on the plate.
When a neuron sends a signal, its electrical potential changes, and this change in potential is detected by sensitive amplifiers connected to the traces for pads near that neuron.
The size of each pad is close to the size of a single neuron, so neuron firing can be localized to a single neuron or small group of neurons by determining from which pad the signal came.

To grow a culture, the MEA glass is first prepared by coating it with laminin and other proteins that enable neurons to bind to the plate surface. 
The presence of this protein creates a surface that cells are able to stick to, but does not guarantee that a cell will adhere to any specific location and grow there. 

In order to acquire cells, mice must be bred and sacrificed, and the fetal mouse neural tissue must be surgically prepared and chemically treated before being plated on the MEA. 
Fetal mice are used as the cell source, because their neurons are still developing and forming connections. 
The chemical treatment uses enzymes to disassociate the individual neurons. 
The neurons are added as a suspension in liquid medium and given some time to bond, after which the culture medium is replaced, removing any unbonded cells with the old culture medium \cite{wagenaar2006extremely}.
Typical cell suspension densities range from 300 to 2,000 cells per square millimeter, but can reach as high as 80,000 cells per square millimeter \cite{shea2009optimization,ruaro2005toward}.
Extremely sparse cultures tend to have high mortality rates and do not form sufficient connections to display mature signaling patterns \cite{shea2009optimization}.

In addition to culture density, the distribution of cells on the plate can be controlled in other ways. 
One method is to apply the suspension of neurons to the desired regions using a micropipette, resulting in higher neuron density in areas where the drops of suspension were added. 
Another method is to apply the adhesive protein to the plate in a pattern. 
The patterned substrate is created by using a process such as microstamping to apply a pattern of binding proteins, rather than an even coating, to the culture area. 
The cells can only adhere to the areas where the protein is applied, so the resulting plate has areas with high cell density and areas with few or no cells.
The pattern of cells influences the connectivity of the culture \cite{sorkin2006compact}.

Because the culture is applied to the plate as a suspension of neurons, there are only limited ways to control the eventual location and distribution of neurons. 
The formation of connections between cells in the culture is also stochastic, though some overall organization is emergent from ``rules'' within each cell. 
As a result, each biological culture is unique and cannot be exactly replaced when it dies. 

When the cells are initially added to the culture, they are not connected. 
For most of the first month in culture, the cells build new connections. 
Starting at around 7 days \emph{in vitro} (DIV) and continuing to around 30 DIV, the connections are not complete, and signaling is dominated by constant, high-amplitude spiking \shortcite{warwick2010controlling}. 
The resulting signals have been described as ``epileptiform."
In the young, epileptiform stage, it is impossible to isolate the neurons' response to stimulus from the constant spike activity, so experiments must be performed after the neuron network is finished developing. 

After the initial period of epileptiform activity, the cells enter a ``mature" phase, characterized by sparse bursts of spikes separated by quiet periods. 
The active bursts may be localized to one region, spread across the culture, or propagate from region to region. 
After 2-3 months of this sort of activity, the culture eventually becomes senescent, and only reacts to stimuli in simple, stereotyped ways \cite{warwick2010controlling}. 
The cells can continue to live for months or even years, assuming that equipment failure or bacterial infection does not kill them \cite{potter2001new}. 

\subsection{Simulated Cultured Neuronal Networks}

In order to simulate a full MEA, the system must model the dispersal of cells over the surface of the MEA, the networking of those cells, and their activity. 
The first part of the simulation is deciding the distribution of the cells over an area according to the density of the desired culture and the surface area of the MEA plate. 
The process of determining the cell locations is called ``plating."
After the plating simulation has placed the cells, a growth simulation uses the locations of the cells to determine how the individual neurons are connected to form the network. 
In order to decide which neurons are connected, mathematical models based on the observed networking behavior of real neurons are used. 
The output of the plating and growth simulations is the connectivity map of a network. 

\section{Plating simulation}

In a typical MEA, the cells are plated on glass prepared with binding proteins, allowed to bond, and then washed, so any cells that are not in contact with the glass are removed.
As a result, all of the cells in the culture are in a single layer on the glass of the MEA.
For the purposes of the plating simulation, the layout of the simulated cells is simplified into a planar grid. 
Each square of the simulated grid is approximately the size of a single neuron cell body (30$\mu$m), and the full grid is 2500$\mu$m square.
These parameters are configurable in the simulation software, to support different types of cells or configurations of MEA.

Cells are distributed on the grid according to a midpoint displacement fractal algorithm \cite{Fournier1982Stochastic}. 
For our simulator, a midpoint displacement fractal was chosen to set the distribution of cell adhesion probabilities because of the similarity of its results to turbulent flows. 
The plasma fractal provides a real-valued probability of each point on the dish being occupied by a cell. 
The uneven distribution of cells in dishes is supported by the uneven areal density of cultures as seen in Shea \citeyear{shea2009optimization}. 

As an alternative to the plasma fractal, the simulator also allows the use of an image to specify the cell occupancy probabilities. 
The red channel of the image is mapped to the grid of points on the dish, with the saturation of color at each point used as the probability of that point containing a cell. 
The image can contain stripes or other patterns, which can be used to simulate micropatterning of the adhesive protein substrate of the dish, or micropipetting of the suspended neurons to specific locations in the dish. 

After the probability of cell placement at each location in the dish is determined, the plating simulation marks each location as occupied or not, based on the probabilities of a location having a cell and the density of cells in the plating solution. 
Those locations that are marked as occupied are treated as having a cell on them. The others are assumed to be empty space. 

After the cell locations are determined, there are a series of pruning steps that are intended to simulate cell deaths in the culture. 
Not all of the cells from the initial plating survive to maturity. 
In biological cultures, 45-60\% of the cells die before the network is done wiring itself, within approximately the first 17 DIV \cite{erickson2008caged}.
Because so many of the cells die off, they do not need to be considered when the simulation begins to determine network connectivity. 
In order to model the early cell mortality, the locations that the simulator has marked as occupied are decimated based on the observed survival probabilities of cells in culture. 
The survival rate, expressed as a percentage, is a configurable parameter of the simulator. 
At present, the pruning function assumes that all cells are equally likely to die, but this function could be updated to bias cell survival rates in a number of ways, such as making cells that are near other cells more likely to survive. 
Obviously, such biases should be supported by observation of biological neuronal networks. 

\section{Connectivity and Growth}

Axons may be of any length. 
In humans, the sciatic axon reaches from the base of the spine to the big toe, nearly a meter. 
Because the active area of an MEA is around 2mm\superscript{2}, it is possible for any cell to be connected to any other cell, resulting in $N\times(N-1)$ possible connections among $N$ cells. 
Typical cell suspension densities are in the range of 300-2000 cells/mm\superscript{2}, resulting in 1200-8000 cells in the active area of the MEA and so millions of possible connections \cite{wagenaar2006extremely}.
However, there are limits on cell growth and networking which make the computation of the network connectivity more tractable. 
Chemical interactions between cells restrict the number of connections that should be considered when developing the connectivity of the dish. 

Kahng, Nam, and Lee \citeyear{kahng2007stochastic} provides a model based on observation of chemotaxis in developing neurons, but simplified into a stochastic model. 
The growing end of an axon moves in a random walk on a grid. 
Each step may take it in any of 8 directions: up, down, left, right, or the four diagonals.
If, after making a step, the walking point is with 20$\mu$m of a dendrite of another neuron, the two neurons are considered connected. 
The paper indicates that the probability of a connection between two cells is effectively a function of the distance between them which makes it unlikely a cell will connect to itself, but likely it will connect to neighbors, and unlikely that it will reach very far \cite{Segev2000185}. 

Our simulator uses a Gaussian distribution to model the probability of a pair of cells connecting based on the straight-line distance between them, with parameters set to maximize connectivity around 200$\mu$m from the cell body. 
The Gaussian distribution also provides a limitation on the number of possible connections that must be considered by the program during the growth simulation. 
If the distance between two cells is so large that the probability of a connection between them is vanishingly small, it may be disregarded when the network is being laid out, thus saving computation time. 

In addition to the limits imposed by chemotaxis, observations of the connections in MEAs performed by confocal microscopy indicate that only 20-50\% of the possible connections are made. 
Once some connectivity threshold has been reached, a neuron will not connect to any other neurons. 
The restriction on connectivity sets an upper limit on the out-degree of neurons, that is, the number of other neurons that they form connections to, considered from the perspective of the connecting neuron. 
A number of possible limitations on the out-degree of neurons have been found in the literature.  

Segev et al. \citeyear{segev2003formation} indicates that cultured neurons tend to send out approximately 10 neurites to connect to other cells. 
The number of outgoing connections provides a good upper bound on the number of connections made by simulated cells, but it seems unrealistic to assume that simply stopping at 10 connections will build a biologically plausible network.

Patel, Scott, and Meaney \citeyear{patel2012dynamic} indicate that the out-degree of neurons can be modeled using a Poisson distribution with a mean of 22. 
Allowing such a stochastic distribution of connectivity will cause some neurons to be extremely well connected while others are less connected. 
Such patterns of connectivity are seen in biological cultures, so the Poisson distribution is used in the simulation to set the out-degree of the neurons. 
Once a neuron forms a number of connections equal to its selected out-degree, no further connections from that neuron are considered, although other neurons may still form connections to it. 

Once the model is completed, it may be run, and voltage and spike train data collected from it. 
Since each neuron is in a known location in the simulated culture, the simulation selects the neurons located on or near the conductive pads for a given MEA layout, and records data from those neurons. 
The Brian simulation software also supports logging of potentials of arbitrary individual neurons as well as collection of spike data from any neuron or set of neurons, including the the possibility of logging the membrane voltage of every neuron in the entire simulated population.
Biological cultures do not support this level of logging detail.  

\section{Neuron models}

For initial development, the cell model used was a simple leaky integrate-and-fire (LIF) model. 
The LIF model was chosen because it is computationally lightweight and displays a sufficient degree of similarity to real neurons to be used in simulation. 
Both Kahng et al. \citeyear{kahng2007stochastic}, and Jolivet, Lewis, and Gerstner \citeyear{jolivet2004generalized} indicate that a LIF model can approximate the spike timing of a living neural network or a more complex mathematical representation of a neuron, to a high degree of accuracy. 
The particular model may have to depend on the cell, but Ostojic, Brunel, and Hakim \citeyear{ostojic2009connectivity} indicates that exponential integrate-and-fire models offer a good match for the behavior of pyramidal cells \emph{in vitro}, so, again, integrate-and-fire models appeared to be both sufficiently accurate and computationally tractable. 

However, it should be noted that the output of a simulated neuron can be examined for accuracy from the standpoint of timing, or by comparison of the actual electrical output. 
From a timing point of view, a simulated neuron is an accurate representation if the spike output of the neuron matches the conditions and timing that would elicit spikes from a biological neuron. 
From the view of electrical output, a simulation of a neuron is accurate if the membrane voltage of the simulation matches that displayed by real neurons, as measured by e.g. patch clamps or MEA electrodes. 
The electrical signal has elements, particularly low-amplitude variations, that are not duplicated by LIF models, but can be approximated by more complex models. 

The LIF model is good for modeling the timing of signals between neurons, but it does not produce biologically plausible action potentials. 
To obtain more realistic spike and sub-threshold voltages, the simulator was converted to use an Izhikevich 2-D integrate and fire model instead of basic LIF neurons \cite{izhikevich2003simple}.
The Izhikevich model has parameters that can be configured to reproduce the behavior of many biological neurons. 
The current configuration of the model uses the configuration that Izhikevich calls ``Regular Spiking'' for excitatory neurons and ``Fast Spiking'' for inhibitory neurons, based on the observed behavior of biological neurons (CITE)

\subsection{Computer Interface}

In order to read neuronal signals from the culture, the MEA is placed in a MEA1060-INV amplifier manufactured by Multi Channel Systems GmbH. 
The amplifer has 60 channels, one for each contact pad of the MEA.
Each channel has a fixed gain of 1200.

The amplifier outputs are connected to a PCI-6071E DAQ card manufactured by National Instruments. 
The DAQ card is responsible for digitizing the output of the amplifier for processing by the computer. 
The card is controlled through the Linux COntrol and MEasurement Device Interface (COMEDI), which provides an open source library for collecting data from DAQ cards. 

The acquisition and processing software is maintained as a collection of ROS nodes (CITE ROS).
The node which acquires data from the DAQ card is called ``Zanni". 
Zanni simply samples the card 1000 times per second and outputs the current value in volts of each channel of the MEA. 
A collection of 60 voltage values is referred to as a ``dish state'' because it represents the electrical activity of the MEA at a specific instant in time. 

Dish states are collected by a ROS node which uses the time series of voltages in each channel to determine the mean and standard deviation of the electrical signal. 
In order to determine the mean and standard deviation, the node first collects a large number of dish states to calculate the mean and standard deviation from. 
Buffering many dish states in this manner allows the system to adapt to the activity levels of a specific culture. 
Any time that the signal on a channel increases beyond 3 standard deviations from the mean for that channel, the channel is considered to be ``spiking''. 
A spike on a channel indicates that a neuron near that channel has produced an action potential. 

In order to convert spikes from the culture into motion commands for the arm, a simplified version of the control scheme used in DeMarse /textit{et al} 2001 is used \cite{demarse2001neurally}. 
For each channel in the dish, if a spike is detected on that channel, the activation at that site is incremented. 
Activation decays exponentially over time 

TODO activation increment and decay functions here

The activation over the entire culture is normalized to the range 0.0 - 1.0 by applying

TODO normalization function here

The resulting vector of 60 values is the activation vector for the dish at a specific time.
Every 0.2 seconds, the activation vector of the culture is compared to a pair of pre-selected activation vectors. 
The pre-selected vectors are a ``right'' and ``left'' vector, with the ``left'' vector having maximum activation at all pads on the left side of the dish, and zero elsewhere, while the ``right'' vector has maximum activation at all pads on the right side of the dish and zero elsewhere. 

\begin{table}
\begin{tabular}{cccccccc}
 & 1.0 & 1.0 & 0.0 & 0.0 & 0.0 & 0.0 &  \\ 
1.0 & 1.0 & 1.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 \\ 
1.0 & 1.0 & 1.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 \\ 
1.0 & 1.0 & 1.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 \\ 
1.0 & 1.0 & 1.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 \\ 
1.0 & 1.0 & 1.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 \\ 
1.0 & 1.0 & 1.0 & 0.0 & 0.0 & 0.0 & 0.0 & 0.0 \\ 
 & 1.0 & 1.0 & 0.0 & 0.0 & 0.0 & 0.0 &  \\ 
\end{tabular}
\caption{Example of an activation vector for activity on the left side of the dish, with each vector element in its location on the dish} 
\end{table}

The comparison is a simple calculation of euclidian distance between the left and right vectors and the current activity vector of the culture. 
If the distance from the current activation vector to the left vector is less than the distance to the right vector the arm will be commanded to move left. 
Similarly, if the current vector is closer to the right than the left vector, the arm will be commanded to move right. 
In either case, the difference between the distances must be large enough to overcome a dead band, or the arm is not instructed to move at all. 



\section{Results}

Control with biological cultures

Noise and noise suppression

Control with an artificial culture

\section{Discussion}

There are computational methods for determining the approximate wiring of a developed culture, based on the propagation delay of a signal in the culture and the synchrony of activity between different sites in the culture  \cite{erickson2008caged,esposti2008estimation}. 
These methods offer some promise for mapping the connectivity of the dish, but they do not give a complete or fully-accurate map. 
Even if it was possible to completely map the connections of a culture, there is no way to duplicate it, as there is no way to control the growth of individual biological neurons and their axons. 


\bibliography{workshop-paper}
\end{document}
